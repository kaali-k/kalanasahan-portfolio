<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List - Kalana Sahan Dillimuni</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #0f0f0f;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Outfit', sans-serif;
        }
        .text-gradient {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent, #ff4b2b, transparent);
            width: 120px;
            margin: 1.5rem auto 3rem auto;
            border-radius: 10px;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        .completed-task {
            text-decoration: line-through;
            color: #666;
        }
        .task-label {
            flex-grow: 1;
            margin-right: 10px;
            word-break: break-word;
            display: block;
        }
        .task-content {
            flex-grow: 1;
            margin-right: 10px;
        }
        .timestamp {
            font-size: 0.75rem;
            color: #666;
            margin-top: 4px;
            display: block;
        }
        .edit-input {
            width: 100%;
            padding: 8px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: #fff;
            outline: none;
        }
        .edit-input:focus {
            border-color: #d63031;
        }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#d63031',
              secondary: '#ff4b2b',
              darkbg: '#0f0f0f',
              lighttext: '#e0e0e0',
            }
          }
        }
      }
    </script>
</head>
<body class="bg-darkbg text-lighttext" x-data="{ mobileMenuOpen: false }">

    <header class="fixed w-full top-0 z-50 transition-all duration-300"
            :class="{ 'bg-black/80 backdrop-blur-md shadow-lg': window.scrollY > 50, 'bg-transparent': window.scrollY <= 50 }"
            @scroll.window="window.scrollY > 50 ? true : false">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center max-w-7xl">
            <a href="../index.html" class="text-2xl font-bold text-primary hover:text-secondary transition duration-300">K.S.D</a>

            <ul class="hidden md:flex space-x-8 items-center">
                <li><a href="../index.html" class="hover:text-primary transition duration-300 font-medium">Home</a></li>
                <li><a href="../projects.html" class="text-white bg-gradient-to-r from-primary to-secondary py-2 px-5 rounded-full hover:opacity-90 transition duration-300 font-semibold shadow-lg shadow-primary/30">Projects</a></li>
                <li><a href="../index.html#about" class="hover:text-primary transition duration-300 font-medium">About</a></li>
                <li><a href="../index.html#skills" class="hover:text-primary transition duration-300 font-medium">Skills</a></li>
                <li><a href="../index.html#contact" class="hover:text-primary transition duration-300 font-medium">Contact</a></li>
            </ul>

            <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden focus:outline-none text-lighttext hover:text-primary text-2xl z-50">
                <i :class="mobileMenuOpen ? 'fas fa-times' : 'fas fa-bars'"></i>
            </button>
        </nav>
    </header>

    <div x-show="mobileMenuOpen"
         class="fixed inset-0 bg-black/95 z-40 flex flex-col items-center justify-center space-y-6 md:hidden"
         @click.away="mobileMenuOpen = false" style="display: none;">
            <a href="../index.html" class="text-2xl hover:text-primary transition duration-300">Home</a>
            <a href="../projects.html" class="text-2xl text-white bg-gradient-to-r from-primary to-secondary py-2 px-5 rounded-full hover:opacity-90 transition duration-300 font-semibold">Projects</a>
            <a href="../index.html#about" class="text-2xl hover:text-primary transition duration-300">About</a>
            <a href="../index.html#skills" class="text-2xl hover:text-primary transition duration-300">Skills</a>
            <a href="../index.html#contact" class="text-2xl hover:text-primary transition duration-300">Contact</a>
    </div>

    <main class="py-20 pt-32 md:pt-40 flex justify-center items-center min-h-screen"> 
        <section id="todo-list-project" class="container mx-auto px-6 max-w-4xl">
            <div class="w-full" data-aos="zoom-in" data-aos-delay="200"> 
                <h2 class="text-3xl md:text-4xl font-bold text-white text-center mb-2" data-aos="fade-up">My To-Do List</h2> 
                <div class="section-divider" data-aos="fade-up" data-aos-delay="100"></div>
                <p class="text-center text-gray-400 mb-8 max-w-xl mx-auto" data-aos="fade-up" data-aos-delay="150">Stay organized and productive.</p>

                <div class="glass-card rounded-2xl shadow-2xl p-6 md:p-8 relative overflow-hidden">
                    <!-- Decorative subtle gradient -->
                    <div class="absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full blur-3xl -mr-32 -mt-32 pointer-events-none"></div>

                    <div class="input-group flex flex-col md:flex-row gap-4 mb-8">
                         <input type="text" class="w-full p-4 bg-white/5 border border-white/10 rounded-xl text-lighttext focus:outline-none focus:ring-2 focus:ring-primary/50 placeholder-gray-500 transition-all" id="taskInput" placeholder="What needs to be done?">
                         <button id="addTaskBtn" class="bg-gradient-to-r from-primary to-secondary hover:shadow-lg hover:shadow-primary/30 text-white font-bold py-3 px-8 rounded-xl cursor-pointer transition duration-300 flex items-center justify-center md:w-auto w-full whitespace-nowrap">
                              <i class="fas fa-plus mr-2"></i> Add Task
                         </button>
                    </div>

                     <ul class="todo-list list-none p-0 m-0 space-y-3" id="todoList">
                     </ul>

                     <div class="border-t border-white/10 mt-8 pt-6 flex flex-wrap justify-center gap-3">
                         <button id="clearCompletedBtn" class="px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-gray-300 hover:text-white transition-all flex items-center">
                             <i class="fas fa-check-circle mr-2 text-green-500"></i> Clear Completed
                         </button>
                         <button id="clearAllBtn" class="px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-gray-300 hover:text-white transition-all flex items-center">
                             <i class="fas fa-trash-alt mr-2 text-red-500"></i> Clear All
                         </button>
                         <button id="downloadBtn" class="px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-gray-300 hover:text-white transition-all flex items-center">
                             <i class="fas fa-download mr-2 text-blue-500"></i> Download
                         </button>
                         <button id="shareBtn" class="px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-gray-300 hover:text-white transition-all flex items-center">
                             <i class="fas fa-share-alt mr-2 text-purple-500"></i> Share
                         </button>
                    </div>

                </div>
            </div>
         </section>
    </main>

    <footer class="bg-black text-gray-500 py-8 mt-12">
        <div class="container mx-auto px-6 text-center">
            <div class="mb-6">
                <p class="text-gray-400 mb-4 text-lg">Follow Me</p>
                <div class="flex justify-center items-center space-x-5 md:space-x-6">
                     <a href="https://web.facebook.com/kalana.sahan.79" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-facebook"></i></a>
                     <a href="https://www.instagram.com/kalana._.sahan/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-instagram"></i></a>
                     <a href="https://www.linkedin.com/in/kalanasahan" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-linkedin"></i></a>
                     <a href="https://www.youtube.com/@Part_of_kaali_life" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-youtube"></i></a>
                     <a href="https://www.tiktok.com/@part_of_kaali_life" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-tiktok"></i></a>
                     <a href="https://github.com/kaali-k" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-primary transition duration-300 text-2xl"><i class="fab fa-github"></i></a>
                </div>
            </div>
            <p>&copy; <span id="currentYear"></span> K.S.D All Rights Reserved.</p>
             <p class="text-sm mt-2">Designed with <i class="fas fa-heart text-primary"></i> using Tailwind CSS & Alpine.js</p>
        </div>
    </footer>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 800, once: false, offset: 50 });
        document.getElementById('currentYear').textContent = new Date().getFullYear();
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const taskInput = document.getElementById('taskInput');
            const addTaskBtn = document.getElementById('addTaskBtn');
            const todoList = document.getElementById('todoList');
            const clearCompletedBtn = document.getElementById('clearCompletedBtn');
            const clearAllBtn = document.getElementById('clearAllBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const shareBtn = document.getElementById('shareBtn');

            addTaskBtn.addEventListener('click', addTask);
            taskInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') addTask();
            });

            clearCompletedBtn.addEventListener('click', clearCompletedTasks);
            clearAllBtn.addEventListener('click', clearAllTasks);
            downloadBtn.addEventListener('click', downloadTasks);
            shareBtn.addEventListener('click', shareTasks);

            loadTasks();

            function formatTimestamp(isoString) {
                 if (!isoString) return '';
                 return new Date(isoString).toLocaleString();
            }

            function addTask() {
                const taskText = taskInput.value.trim();
                if (taskText === '') {
                    alert('Please enter a task!');
                    return;
                }
                const task = {
                    text: taskText,
                    completed: false,
                    addedAt: new Date().toISOString(),
                    completedAt: null
                };
                saveTaskToStorage(task);
                renderTask(task);
                taskInput.value = '';
            }

            function renderTask(task) {
                const listItem = document.createElement('li');
                listItem.className = 'glass-card p-4 flex items-center justify-between group hover:bg-white/5 transition-all duration-300 border border-white/5';
                
                // Checkbox
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = task.completed;
                checkbox.className = 'w-5 h-5 text-primary bg-gray-700 border-gray-600 rounded focus:ring-primary focus:ring-2 cursor-pointer mr-4 accent-primary';

                checkbox.addEventListener('change', function() {
                    task.completed = checkbox.checked;
                    task.completedAt = task.completed ? new Date().toISOString() : null;
                    updateTaskInStorage(task); 
                    
                    const timeSpan = listItem.querySelector('.completed-timestamp');
                    if(task.completed) {
                         timeSpan.textContent = `Completed: ${formatTimestamp(task.completedAt)}`;
                         timeSpan.classList.remove('hidden');
                    } else {
                         timeSpan.classList.add('hidden');
                    }
                    listItem.querySelector('.task-label').classList.toggle('completed-task', task.completed);
                });

                const taskContentDiv = document.createElement('div');
                taskContentDiv.classList.add('task-content');

                const taskLabel = document.createElement('label');
                taskLabel.textContent = task.text;
                taskLabel.className = `task-label text-gray-200 cursor-pointer text-lg font-medium ${task.completed ? 'completed-task' : ''}`;

                const addedTimestampSpan = document.createElement('span');
                addedTimestampSpan.className = 'timestamp text-xs text-gray-500 mt-1';
                addedTimestampSpan.textContent = `Added: ${formatTimestamp(task.addedAt)}`;

                const completedTimestampSpan = document.createElement('span');
                completedTimestampSpan.className = `timestamp completed-timestamp text-xs text-green-500/80 mt-1 ${task.completed && task.completedAt ? '' : 'hidden'}`;
                if (task.completed && task.completedAt) {
                     completedTimestampSpan.textContent = `Completed: ${formatTimestamp(task.completedAt)}`;
                }

                // Edit functionality
                taskLabel.addEventListener('dblclick', function() {
                     if (task.completed) return;
                     const currentText = taskLabel.textContent;
                     const editInput = document.createElement('input');
                     editInput.type = 'text';
                     editInput.value = currentText;
                     editInput.className = 'edit-input'; 
                     
                     taskContentDiv.replaceChild(editInput, taskLabel);
                     editInput.focus();

                     const save = () => {
                          const newText = editInput.value.trim();
                          if (newText === '') {
                              deleteTask(task.addedAt, listItem); 
                          } else {
                              task.text = newText;
                              updateTaskInStorage(task);
                              taskLabel.textContent = newText;
                              taskContentDiv.replaceChild(taskLabel, editInput);
                          }
                     };

                     editInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') save(); });
                     editInput.addEventListener('blur', save);
                });

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'text-gray-500 hover:text-red-500 transition-colors duration-300 p-2 text-lg opacity-0 group-hover:opacity-100 focus:opacity-100';
                deleteBtn.innerHTML = '<i class="fas fa-trash-alt"></i>';
                deleteBtn.addEventListener('click', () => deleteTask(task.addedAt, listItem));

                taskContentDiv.appendChild(taskLabel);
                taskContentDiv.appendChild(addedTimestampSpan);
                taskContentDiv.appendChild(completedTimestampSpan);

                listItem.appendChild(checkbox);
                listItem.appendChild(taskContentDiv);
                listItem.appendChild(deleteBtn);

                todoList.appendChild(listItem);
            }

            function getTasksFromStorage() {
                return JSON.parse(localStorage.getItem('todoTasks') || '[]');
            }

            function saveTaskToStorage(task) {
                const tasks = getTasksFromStorage();
                tasks.push(task);
                localStorage.setItem('todoTasks', JSON.stringify(tasks));
            }

            function updateTaskInStorage(updatedTask) {
                const tasks = getTasksFromStorage();
                const index = tasks.findIndex(t => t.addedAt === updatedTask.addedAt);
                if (index !== -1) {
                    tasks[index] = updatedTask;
                    localStorage.setItem('todoTasks', JSON.stringify(tasks));
                }
            }

            function deleteTask(addedAt, listItem) {
                const tasks = getTasksFromStorage().filter(t => t.addedAt !== addedAt);
                localStorage.setItem('todoTasks', JSON.stringify(tasks));
                if(listItem) todoList.removeChild(listItem);
            }

            function loadTasks() {
                todoList.innerHTML = '';
                const tasks = getTasksFromStorage();
                tasks.forEach(task => renderTask(task));
            }

            function clearCompletedTasks() {
                 let tasks = getTasksFromStorage();
                 const completed = tasks.filter(t => t.completed);
                 if (completed.length === 0) { alert("No completed tasks!"); return; }
                 
                 if (confirm(`Clear ${completed.length} completed tasks?`)) {
                      tasks = tasks.filter(t => !t.completed);
                      localStorage.setItem('todoTasks', JSON.stringify(tasks));
                      loadTasks();
                 }
            }

            function clearAllTasks() {
                 if (getTasksFromStorage().length === 0) { alert("No tasks to clear!"); return; }
                 if (confirm('Clear all tasks?')) {
                      localStorage.removeItem('todoTasks');
                      loadTasks();
                 }
            }

            function downloadTasks() {
                const tasks = getTasksFromStorage();
                if (tasks.length === 0) { alert("No tasks!"); return; }
                
                const lines = tasks.map(t => {
                     const status = t.completed ? '[X]' : '[ ]';
                     const time = `(Added: ${formatTimestamp(t.addedAt)})`;
                     return `${status} ${t.text} ${time}`;
                });
                
                const blob = new Blob([lines.join('\n')], { type: 'text/plain' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'My_ToDo_List.txt';
                link.click();
            }

            function shareTasks() {
                 const tasks = getTasksFromStorage();
                 if (tasks.length === 0) { alert("No tasks!"); return; }
                 
                 const text = 'My To-Do List:\n' + tasks.map(t => `${t.completed ? '[X]' : '[ ]'} ${t.text}`).join('\n');
                 if (navigator.share) {
                     navigator.share({ title: 'My To-Do List', text: text });
                 } else {
                     navigator.clipboard.writeText(text).then(() => alert('Copied to clipboard!'));
                 }
            }
        });
    </script>
</body>
</html>

